<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ìƒì„±ê¸° V8.1 (Fixed)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <style>
        body { font-family: Pretendard, sans-serif; background-color: #f3f4f6; }
        .input-label { display: block; font-size: 0.85rem; font-weight: 700; color: #4b5563; margin-bottom: 6px; }
        .input-field { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; margin-bottom: 16px; font-size: 0.95rem; }
        
        /* [ìˆ˜ì •ë¨] ring ì†ì„± ì œê±° -> box-shadowë¡œ ëŒ€ì²´ */
        .input-field:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px #bfdbfe; }
        
        .section-box { background: white; padding: 24px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .img-preview-box { width: 100%; height: 150px; background-color: #f3f4f6; border: 2px dashed #d1d5db; border-radius: 8px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 10px; position: relative; cursor: pointer; transition: 0.2s; }
        .img-preview-box:hover { border-color: #2563eb; background-color: #eff6ff; }
        .img-preview-box img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body class="p-6 max-w-4xl mx-auto">

    <header class="mb-8 flex justify-between items-end border-b pb-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">ğŸ› ï¸ ìƒí’ˆ ìƒì„±ê¸° V8.1</h1>
            <p class="text-sm text-gray-500 mt-1">CSS ì˜¤ë¥˜ ìˆ˜ì • ë° ì´ë¯¸ì§€ í”„ë¦¬ë·° ê¸°ëŠ¥ íƒ‘ì¬</p>
        </div>
        <button onclick="generateCode()" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:bg-blue-700 transition shadow-lg">
            ì½”ë“œ ìƒì„±í•˜ê¸° ğŸš€
        </button>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        
        <div class="md:col-span-2">
            
            <div class="section-box border-l-4 border-blue-500">
                <h2 class="text-lg font-bold mb-4">ğŸ¨ 1. ìŠ¤íƒ€ì¼ ì„¤ì • (Figma Style)</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="input-label">ë¸Œëœë“œ ì»¬ëŸ¬</label>
                        <div class="flex gap-2">
                            <input type="color" id="s_color" class="h-10 w-12 cursor-pointer rounded border" value="#2A4700">
                            <input type="text" id="s_color_code" class="input-field mb-0" value="#2A4700" readonly>
                        </div>
                    </div>
                    <div>
                        <label class="input-label">ëª¨ì„œë¦¬ ë‘¥ê¸€ê¸°</label>
                        <select id="s_radius" class="input-field mb-0">
                            <option value="rounded-none">ì§ê° (0px)</option>
                            <option value="rounded-lg">ì‚´ì§ (8px)</option>
                            <option value="rounded-2xl">ë¶€ë“œëŸ½ê²Œ (16px)</option>
                            <option value="rounded-[40px]" selected>ë‘¥ê¸€ê²Œ (40px)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="section-box">
                <h2 class="text-lg font-bold mb-4">ğŸ“ 2. ìƒí’ˆ ê¸°ë³¸ ì •ë³´</h2>
                <label class="input-label">ìƒí’ˆ ì œëª©</label>
                <input type="text" id="title" class="input-field" value="ë‚˜ì˜¤ì‹œë§ˆ ë¯¸ì‹ ì›Œí‚¹íˆ¬ì–´">
                
                <label class="input-label">ì„œë¸Œ ì¹´í”¼</label>
                <input type="text" id="sub" class="input-field" value="ì˜ˆìˆ ê³¼ ë¯¸ì‹ì´ í•¨ê»˜í•˜ëŠ” ì„¬ ì—¬í–‰">
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="input-label">í´ë”ëª… (ì˜ë¬¸)</label>
                        <input type="text" id="folder" class="input-field" value="naoshima">
                    </div>
                    <div>
                        <label class="input-label">íŒë§¤ê°€ (ì›)</label>
                        <input type="number" id="price" class="input-field" value="89000">
                    </div>
                </div>
            </div>

            <div class="section-box">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold">â° 3. ì½”ìŠ¤ íƒ€ì„ë¼ì¸</h2>
                    <button onclick="addTimeline()" class="text-sm bg-gray-100 px-3 py-1 rounded hover:bg-gray-200">+ ì¶”ê°€</button>
                </div>
                <div id="timeline_area" class="space-y-4"></div>
            </div>

            <div class="section-box">
                <h2 class="text-lg font-bold mb-4">ğŸ“„ 4. ìƒì„¸ ì •ë³´</h2>
                
                <label class="input-label">ì¶”ì²œ í¬ì¸íŠ¸ (3ì¤„)</label>
                <textarea id="recommends" class="input-field h-24" placeholder="ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„">ë¯¸ìˆ ê´€ë§Œ ì°ëŠ” ì—¬í–‰ì´ ì‹«ìœ¼ì‹  ë¶„&#13;&#10;ì‘í’ˆ ë°°ê²½ ì„¤ëª…ì´ í•„ìš”í•œ ë¶„&#13;&#10;ë§›ìˆëŠ” ë¡œì»¬ ì‹ì‚¬ë¥¼ ì›í•˜ì‹œëŠ” ë¶„</textarea>

                <label class="input-label">ê°€ì´ë“œ ì†Œê°œ</label>
                <div class="grid grid-cols-3 gap-2">
                    <input type="text" id="g_name" class="input-field col-span-1" value="ì „ë¬¸ ê°€ì´ë“œ">
                    <input type="text" id="g_desc" class="input-field col-span-2" value="ê±´ì¶•ê³¼ ì˜ˆìˆ ì„ ì‚¬ë‘í•˜ëŠ” ê°€ì´ë“œì…ë‹ˆë‹¤.">
                </div>
            </div>

        </div>

        <div class="md:col-span-1">
            <div class="section-box sticky top-6">
                <h2 class="text-lg font-bold mb-4 text-red-600">ğŸ“· ì´ë¯¸ì§€ ê°€ì´ë“œ</h2>
                <p class="text-xs text-gray-500 mb-4">
                    ì—¬ê¸°ëŠ” <strong>ë¯¸ë¦¬ë³´ê¸°ìš©</strong>ì…ë‹ˆë‹¤.<br>
                    ì‹¤ì œ <code>images</code> í´ë”ì— ì•„ë˜ ë²ˆí˜¸ë¡œ íŒŒì¼ì„ ë„£ì–´ì£¼ì„¸ìš”.
                </p>

                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span>1. ë©”ì¸ ë°°ë„ˆ</span>
                            <span class="text-red-500">1.jpg</span>
                        </div>
                        <div class="img-preview-box" onclick="document.getElementById('file1').click()">
                            <span class="text-gray-400 text-xs">í´ë¦­í•˜ì—¬ í™•ì¸</span>
                            <img id="prev1" class="hidden">
                        </div>
                        <input type="file" id="file1" class="hidden" onchange="preview(this, 'prev1')">
                    </div>

                    <div>
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span>2. ìƒì„¸ ì´ë¯¸ì§€ 1</span>
                            <span class="text-red-500">2.jpg</span>
                        </div>
                        <div class="img-preview-box" onclick="document.getElementById('file2').click()">
                            <span class="text-gray-400 text-xs">í´ë¦­í•˜ì—¬ í™•ì¸</span>
                            <img id="prev2" class="hidden">
                        </div>
                        <input type="file" id="file2" class="hidden" onchange="preview(this, 'prev2')">
                    </div>

                    <div>
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span>3. ê°€ì´ë“œ í”„ë¡œí•„</span>
                            <span class="text-red-500">3.jpg</span>
                        </div>
                        <div class="img-preview-box" onclick="document.getElementById('file3').click()">
                            <span class="text-gray-400 text-xs">í´ë¦­í•˜ì—¬ í™•ì¸</span>
                            <img id="prev3" class="hidden">
                        </div>
                        <input type="file" id="file3" class="hidden" onchange="preview(this, 'prev3')">
                    </div>

                    <div id="dynamic_images" class="border-t pt-2 mt-2">
                        <p class="text-xs text-center text-gray-400">íƒ€ì„ë¼ì¸ ì´ë¯¸ì§€ëŠ” 4ë²ˆë¶€í„° ìë™ í• ë‹¹</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="result_modal" class="fixed inset-0 bg-black/50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-xl w-full max-w-2xl h-[80vh] flex flex-col">
            <h2 class="text-xl font-bold mb-4">ğŸ‰ ìƒì„± ì™„ë£Œ!</h2>
            <p class="text-sm text-gray-600 mb-2">1. ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ <strong>[í´ë”ëª…]/index.html</strong>ë¡œ ì €ì¥í•˜ì„¸ìš”.</p>
            <textarea id="final_code" class="w-full flex-grow p-4 bg-gray-800 text-green-400 font-mono text-xs rounded-lg mb-4"></textarea>
            
            <p class="text-sm text-gray-600 mb-2">2. ëª©ì°¨ í˜ì´ì§€ìš© ì¹´ë“œ ì½”ë“œ</p>
            <textarea id="final_card" class="w-full h-24 p-4 bg-gray-100 text-gray-600 font-mono text-xs rounded-lg mb-4"></textarea>

            <button onclick="document.getElementById('result_modal').classList.add('hidden')" class="bg-gray-200 py-3 rounded-lg font-bold hover:bg-gray-300">ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        // ìƒ‰ìƒ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('s_color').addEventListener('input', (e) => {
            document.getElementById('s_color_code').value = e.target.value;
        });

        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë¡œì§
        function preview(input, imgId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById(imgId);
                    img.src = e.target.result;
                    img.classList.remove('hidden');
                    img.previousElementSibling.classList.add('hidden'); 
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // íƒ€ì„ë¼ì¸ ì¶”ê°€ ë¡œì§
        function addTimeline(time='', title='', desc='', hasImg=false) {
            const area = document.getElementById('timeline_area');
            const div = document.createElement('div');
            div.className = 'border p-3 rounded-lg bg-gray-50 timeline-item mb-2';
            div.innerHTML = `
                <div class="flex gap-2 mb-2">
                    <input type="text" class="input-field mb-0 w-1/4 t-time" placeholder="10:00" value="${time}">
                    <input type="text" class="input-field mb-0 w-3/4 t-title" placeholder="ì¼ì • ì œëª©" value="${title}">
                </div>
                <textarea class="input-field mb-2 h-16 t-desc" placeholder="ìƒì„¸ ë‚´ìš©">${desc}</textarea>
                <div class="flex justify-between items-center">
                    <label class="flex items-center gap-2 text-sm cursor-pointer p-1 rounded hover:bg-gray-200">
                        <input type="checkbox" class="t-check accent-blue-600" ${hasImg ? 'checked' : ''} onchange="updateDynamicImages()">
                        <span class="img-label font-bold text-gray-500">ğŸ“¸ ì´ë¯¸ì§€ ì¶”ê°€</span>
                    </label>
                    <button onclick="this.closest('.timeline-item').remove(); updateDynamicImages()" class="text-red-500 text-xs underline">ì‚­ì œ</button>
                </div>
            `;
            area.appendChild(div);
            updateDynamicImages();
        }

        // ë™ì  ì´ë¯¸ì§€ ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸ (ì˜¤ë¥¸ìª½ íŒ¨ë„)
        function updateDynamicImages() {
            const container = document.getElementById('dynamic_images');
            container.innerHTML = '<p class="text-xs text-center text-gray-400 mb-2 mt-4">-- íƒ€ì„ë¼ì¸ ì¶”ê°€ ì´ë¯¸ì§€ --</p>';
            
            let imgNum = 4;
            const checks = document.querySelectorAll('.t-check');
            
            checks.forEach((chk) => {
                const label = chk.nextElementSibling;
                if(chk.checked) {
                    // ë¼ë²¨ ì—…ë°ì´íŠ¸
                    label.innerText = `ğŸ“¸ ì´ë¯¸ì§€ ì¶”ê°€ (#${imgNum}.jpg)`;
                    label.classList.add('text-blue-600');
                    label.classList.remove('text-gray-500');

                    // ì˜¤ë¥¸ìª½ íŒ¨ë„ ì¶”ê°€
                    const div = document.createElement('div');
                    div.className = 'mb-2';
                    const currentNum = imgNum; // í´ë¡œì € ìº¡ì²˜
                    div.innerHTML = `
                        <div class="flex justify-between text-xs font-bold mb-1">
                            <span>#${currentNum}. íƒ€ì„ë¼ì¸</span>
                            <span class="text-red-500">${currentNum}.jpg</span>
                        </div>
                        <div class="img-preview-box h-24" onclick="document.getElementById('file_d_${currentNum}').click()">
                            <span class="text-gray-400 text-xs">ì„ íƒ</span>
                            <img id="prev_d_${currentNum}" class="hidden">
                        </div>
                        <input type="file" id="file_d_${currentNum}" class="hidden" onchange="preview(this, 'prev_d_${currentNum}')">
                    `;
                    container.appendChild(div);
                    imgNum++;
                } else {
                    label.innerText = "ğŸ“¸ ì´ë¯¸ì§€ ì¶”ê°€ (ì‚¬ìš© ì•ˆ í•¨)";
                    label.classList.add('text-gray-500');
                    label.classList.remove('text-blue-600');
                }
            });
        }

        // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
        window.onload = function() {
            addTimeline('09:00', 'ë¯¸íŒ…', 'í•­êµ¬ì—ì„œ ë§Œë‚˜ìš”', false);
            addTimeline('10:00', 'ì˜¤ì „ íˆ¬ì–´', 'ì£¼ìš” ëª…ì†Œë¥¼ ë´…ë‹ˆë‹¤.', true);
        };

        // â˜… ì½”ë“œ ìƒì„±
        function generateCode() {
            const d = {
                color: document.getElementById('s_color').value,
                radius: document.getElementById('s_radius').value,
                title: document.getElementById('title').value,
                sub: document.getElementById('sub').value,
                folder: document.getElementById('folder').value,
                price: Number(document.getElementById('price').value).toLocaleString(),
                recommends: document.getElementById('recommends').value.split('\n'),
                guide: { name: document.getElementById('g_name').value, desc: document.getElementById('g_desc').value }
            };

            let imgIdx = 4;
            let timelineHtml = '';
            document.querySelectorAll('.timeline-item').forEach((item, idx) => {
                const time = item.querySelector('.t-time').value;
                const title = item.querySelector('.t-title').value;
                const desc = item.querySelector('.t-desc').value.replace(/\n/g, '<br>');
                const hasImg = item.querySelector('.t-check').checked;
                const isLast = idx === document.querySelectorAll('.timeline-item').length - 1 ? 'last-item' : '';

                let dotStyle = `background-color: white; border: 2px solid #d1d5db; color: #111827;`;
                if(title.includes('ë¯¸íŒ…') || title.includes('ê´€ëŒ')) dotStyle = `background-color: ${d.color}; border: none; color: white;`;

                let imgCode = '';
                if(hasImg) {
                    imgCode = `<div class="${d.radius} overflow-hidden shadow-sm h-40 bg-gray-200 mt-3 mb-3"><img data-img="${imgIdx}" class="w-full h-full object-cover auto-img"></div>`;
                    imgIdx++;
                }

                timelineHtml += `
                <div class="flex gap-4 mb-10 relative z-10 ${isLast}">
                    <div class="timeline-line"></div>
                    <div class="w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold shrink-0 z-10" style="${dotStyle}">${time}</div>
                    <div class="w-full">
                        <h3 class="font-bold text-lg text-gray-900">${title}</h3>
                        <p class="text-sm text-gray-600 mt-1 leading-relaxed">${desc}</p>
                        ${imgCode}
                    </div>
                </div>`;
            });

            // ìŠ¤í¬ë¦½íŠ¸ ë¶„ë¦¬ (ì˜¤ë¥˜ ë°©ì§€)
            const S_OPEN = '<' + 'script' + '>';
            const S_CLOSE = '<' + '/' + 'script' + '>';

            const finalHtml = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${d.title}</title>
    ${S_OPEN} src="https://cdn.tailwindcss.com">${S_CLOSE}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <style>
        body { font-family: Pretendard, sans-serif; }
        .timeline-line { position: absolute; left: 19px; top: 10px; bottom: -20px; width: 2px; background-color: #E5E7EB; z-index: 0; }
        .last-item .timeline-line { display: none; }
        .auto-img { min-height: 50px; background-color: #E5E7EB; }
    </style>
</head>
<body class="bg-[#F2F3F5] min-h-screen flex justify-center">
    <div class="w-full max-w-[430px] bg-white min-h-screen shadow-2xl relative pb-36">
        
        <div class="relative w-full h-[500px] bg-gray-200">
            <div class="absolute top-0 left-0 w-full z-20 flex justify-between p-5 pt-6 text-white">
                <a href="../index.html" class="text-2xl drop-shadow-md">â†</a>
                <div class="flex gap-4"><button>â™¥</button><button>ğŸ”—</button></div>
            </div>
            <img data-img="1" class="w-full h-full object-cover auto-img">
            <div class="absolute bottom-0 w-full h-[300px] bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>
            <div class="absolute bottom-10 left-6 right-6 text-white">
                <span class="text-xs px-2 py-1 rounded border border-white/30" style="background-color:${d.color}">New</span>
                <h1 class="text-[28px] font-bold leading-tight mt-2">${d.title}</h1>
                <p class="text-[15px] opacity-90 mt-1">${d.sub}</p>
            </div>
        </div>

        <div class="bg-white ${d.radius} -mt-6 relative z-10 px-6 pt-8 pb-6 shadow-sm">
            <div class="bg-[#F9FAFB] rounded-2xl p-5">
                <span class="font-bold text-xs mb-2 block" style="color:${d.color}">ğŸ’¡ ì¶”ì²œ í¬ì¸íŠ¸</span>
                <ul class="text-sm text-gray-600 space-y-2">
                    ${d.recommends.map(r => `<li>âœ” ${r}</li>`).join('')}
                </ul>
            </div>
        </div>
        <div class="h-3 bg-[#F2F3F5]"></div>

        <div class="bg-white py-10 px-6">
            <h2 class="text-xl font-bold mb-6" style="color:${d.color}">ì™œ ì´ íˆ¬ì–´ì—¬ì•¼ í• ê¹Œìš”?</h2>
            <div class="mt-8 ${d.radius} overflow-hidden h-48 bg-gray-200"><img data-img="2" class="w-full h-full object-cover auto-img"></div>
        </div>
        <div class="h-3 bg-[#F2F3F5]"></div>

        <div class="bg-white py-10 px-6">
            <h2 class="text-xl font-bold mb-8">ğŸ—ºï¸ ì½”ìŠ¤ ì•ˆë‚´</h2>
            <div class="relative pl-2">${timelineHtml}</div>
        </div>
        <div class="h-3 bg-[#F2F3F5]"></div>

        <div class="bg-white py-10 px-6 text-center">
            <span class="border px-2 py-0.5 rounded-full text-xs font-bold" style="color:${d.color}; border-color:${d.color}">HOST</span>
            <h2 class="text-xl font-bold mb-4 mt-3">${d.guide.name}</h2>
            <img data-img="3" class="w-[120px] h-[120px] object-cover rounded-full mx-auto mb-5 shadow-lg border-4 border-white auto-img">
            <p class="text-gray-600 text-sm">${d.guide.desc}</p>
        </div>

        <div class="fixed bottom-0 max-w-[430px] w-full bg-white border-t p-4 pb-8 z-50 flex justify-between items-center shadow-lg">
            <div class="flex flex-col"><span class="text-xs text-gray-400">íŒë§¤ê°€</span><span class="font-bold text-xl" style="color:${d.color}">${d.price}ì›</span></div>
            <button class="text-white font-bold py-3 px-8 rounded-xl shadow-lg" style="background-color:${d.color}">ì˜ˆì•½í•˜ê¸°</button>
        </div>
    </div>

    ${S_OPEN}
        document.addEventListener("DOMContentLoaded",()=>{
            const images = document.querySelectorAll(".auto-img");
            const exts = ["jpg","png","jpeg","webp"];
            images.forEach(img => {
                const id = img.getAttribute("data-img");
                if(!id) return;
                let attempt = 0;
                function tryLoad() {
                    if(attempt >= exts.length) return;
                    const src = "./images/" + id + "." + exts[attempt];
                    const temp = new Image();
                    temp.src = src;
                    temp.onload = () => { img.src = src; };
                    temp.onerror = () => { attempt++; tryLoad(); };
                }
                tryLoad();
            });
        });
    ${S_CLOSE}
</body>
</html>`;

            document.getElementById('final_code').value = finalHtml;
            
            // ì¹´ë“œ ì½”ë“œ
            document.getElementById('final_card').value = `<a href="./${d.folder}/index.html" class="block group">
    <div class="bg-white border rounded-2xl p-5 hover:border-[${d.color}] transition shadow-sm hover:shadow-md">
        <h3 class="font-bold text-lg text-gray-800 mb-1" style="color:${d.color}">${d.title}</h3>
        <p class="text-xs text-gray-500">${d.sub}</p>
    </div>
</a>`;

            document.getElementById('result_modal').classList.remove('hidden');
        }
    </script>
</body>
</html>